/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */
subprojects {
    apply plugin: 'java'
    group 'com.github.bsfowlie.tilegame'
    version '1.0-SNAPSHOT'
    sourceCompatibility = JavaVersion.VERSION_11
    repositories {
        jcenter()
    }
    ext {
        assertjVersion = '3.14.0'
        assertjSwingVersion = '3.9.2'
        mockitoVersion = '3.2.0'
        jupiterVersion = '5.5.1'
    }
    sourceSets {
        integration {
            compileClasspath += sourceSets.main.output
            runtimeClasspath += sourceSets.main.output
        }
    }
    configurations {
        integrationImplementation.extendsFrom testImplementation
        integrationRuntimeOnly.extendsFrom testRuntimeOnly
    }
    dependencies {
        testImplementation "org.assertj:assertj-core:$assertjVersion"
        testImplementation "org.mockito:mockito-core:$mockitoVersion"
        testImplementation "org.mockito:mockito-junit-jupiter:$mockitoVersion"
        testImplementation "org.junit.jupiter:junit-jupiter-api:$jupiterVersion"
        testImplementation "org.junit.jupiter:junit-jupiter-params:$jupiterVersion"
        testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:$jupiterVersion"
        integrationImplementation("org.assertj:assertj-swing-junit:$assertjSwingVersion") {
            exclude group: 'junit', module: 'junit'
        }
    }
    test {
        useJUnitPlatform()
    }
    task integration(type: Test) {
        description = 'Runs the integration tests.'
        group = 'verification'

        testClassesDirs = sourceSets.integration.output.classesDirs
        classpath = sourceSets.integration.runtimeClasspath

        useJUnitPlatform()

        shouldRunAfter test
    }
    check.dependsOn integration
}

project(':engine') {
    apply plugin: 'java-library'
}

project(':application') {
    apply plugin: 'application'
    dependencies {
        implementation project(':engine')
    }
    application {
        mainClassName = 'com.github.bsfowlie.tilegame.Main'
    }
}
